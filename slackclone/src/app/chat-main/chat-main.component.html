<mat-sidenav-container class="chat-main-wrapper">
    <div class="chat-main"
        [ngStyle]="{'height': messageImages.length != 0 ? 'calc(100% - 286px)' : 'calc(100% - 200px)'}">
        <div class="element_header" [ngStyle]="{'border-bottom': '2px solid'}">
            <p>{{this.fcctService.midContent.header}}</p>
        </div>
        <div class="messages_wrapper">
            <div *ngIf="this.fcctService.midContent.messages.length == 0">nothing in here</div>
            <div *ngFor="let message of this.fcctService.midContent.messages" class="message">
                <div *ngIf="message.thread.length == 0" class="start_thread_icon_wrapper">
                    <div (click)="this.fcctService.openThread(message.timestamp)" class="start_thread_icon">
                        open Thread
                    </div>
                </div>
                <div class="profilpicture">
                    <img class="avatar" src="{{this.fb.getUserFromList(message.creator).image}}">
                </div>
                <div class="message-body">
                    <div class="header">
                        <h4>{{this.fsMain.getUserFromList(message.creator).fullname}}</h4>
                        <h5>{{message.timestamp.toMillis() | date:'medium'}}</h5>
                    </div>
                    <div [innerHtml]="message.message"></div>
                    <div class="message-img-container">
                        <img *ngFor="let img of message.images" class="message-img" src={{img}} width="auto"
                            height="150" (click)="this.uiService.imagePopup(img)">
                    </div>

                    <div *ngIf="message.thread.length != 0" class="thread_link"
                        (click)="this.fcctService.openThread(message.timestamp)">{{ message.thread.length }} Antworten
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="editor" [ngStyle]="{'bottom': messageImages.length != 0 ? '86px' : '0px'}">
        <editor [(ngModel)]="noteText" (onChange)="logChange()"
            apiKey="tcf6s96vi3ln7h1sgtod2tzjhnfnrgsypmimricsl27j6wc9" [init]="{
        height: 200,
        menubar: false,
        selector: '',
        base_url: '/tinymce',
        suffix: '.min',
        plugins: [
          'emoticons', 'lists', 'link'
        ],
        toolbar:
          'undo redo | link | bold italic backcolor | \
          bullist numlist | removeformat | emoticons ',
          emoticons_database: 'emojis'
      }">
        </editor>
    </div>
    <div class="upload-wrapper" *ngIf="messageImages.length != 0 || isUploading">
        <div class="upload-img-area" *ngFor="let url of messageImages; index as i">
            <div class="image-container"><img src={{url}} width="62" height="62">
                <div class="cancel material-icons" (click)="deleteImg(i)">cancel</div>
            </div>
        </div>
        <img *ngIf="isUploading" src="./assets/img/spinner.jpg" width="auto" height="62">
    </div>
    <div class="message-controller ">
        <input style="display: none" type="file" accept=".png,.jpg" #fileInput (change)="upload($event)" />
        <div class="control-upload-img material-icons" (click)="fileInput.click()">upload</div>
        <button class="control-send-msg material-icons" [class.dirty]="!noteText && !messageImages[0] || isUploading"
            (click)="addMessage()" [disabled]="!noteText && !messageImages[0] || isUploading">send</button>
    </div>
</mat-sidenav-container>